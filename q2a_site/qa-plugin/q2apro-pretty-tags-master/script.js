$(document).ready(function(){
	var isIE11 = !!navigator.userAgent.match(/Trident\/7\./);
	// load jquery tags script for question page, if not mobile, not working in IE, off-cookie not set
	if( !isIE11 && !ismobile && !(/MSIE (\d+\.\d+);/.test(navigator.userAgent)) ) {
		var tagsArray = qa_tags_complete.split(',');
		tagsArray.sort();
		// assign plugin to tags
		$('#tags').tagbox({
			// transform tags string into array (plugin needs array)
			url: tagsArray,
			separator: ' ',
		});
		// remove example q2a default tags
		$('#tag_examples_title').hide();
		$('#tag_complete_title').hide();
		$('#tag_hints').hide();
		// kill q2a bring-up tags function by killing the event
		$('#tags').attr('onkeyup',null);
		$('#tags').attr('onmouseup',null);
		$('#title').attr('onkeyup',null);
	}

	// disable enter key for tags input
	$("#tags").keypress(function(e) {
		if (e.which == 13) { return false; }
	});
});
	
/* Simple autocomplete plugin with full keyboard navigation. Tag input plugin. @author Bastian Allgeier <bastian@getkirby.com> @copyright Bastian Allgeier 2012 @license MIT https://github.com/bastianallgeier/Tags */
(function(a){a.autocomplete=function(e,d,c){var g={url:false,apply:function(h){b.val(h)}};var f=this;f.settings={};var b=a(e),e=e;f.init=function(){f.settings=a.extend({},g,c);f.input=b;f.ignore=[];f.data={};f.open=false;f.load();f.blocker=a('<div class="autocomplete-blocker"></div>').css({position:"fixed",top:0,left:0,right:0,bottom:0,"z-index":1999}).hide();f.box=a('<div class="autocomplete"></div>').css("z-index",2000);f.ul=a("<ul></ul>");f.blocker.click(function(h){f.kill();f.input.focus();h.stopPropagation()});b.keyup(function(i){f.pos=f.selection();switch(i.keyCode){case 13:f.apply();case 27:f.kill();case 38:case 40:return false;case 39:var h=f.value();if(h.length>0&&f.pos==f.input.val().length){f.apply()}break;case 188:f.apply();default:f.complete(a(this).val());break}});b.keydown(function(h){f.pos=f.selection();switch(h.keyCode){case 9:if(f.value().length>0){f.apply();return false}else{return true}break;case 38:f.prev();return false;case 40:f.next();return false}});f.box.click(function(h){h.stopPropagation()});a("body").append(f.box);a("body").append(f.blocker);a(window).resize(f.position);f.position()};f.load=function(){if(typeof d=="object"){f.data=d}else{a.getJSON(d,function(h){f.data=h})}};f.complete=function(j){f.kill();f.position();var i=0;var j=a.trim(j);if(j.length==0){return false}var k=new RegExp("^"+j,"i");var h=f.data.filter(function(l){if(f.ignore.indexOf(l)==-1&&l.match(k)){return l}});h=h.slice(0,5);a.each(h,function(n,m){var l=a("<li>"+m+"</li>");l.click(function(){f.apply(m)});l.mouseover(function(){f.ul.find(".selected").removeClass("selected");l.addClass("over")});l.mouseout(function(){l.removeClass("over")});f.ul.append(l);if(i==0){l.addClass("first selected")}i++});if(i>0){f.box.append(f.ul.show());f.blocker.show();f.open=true}};f.kill=function(){f.blocker.hide();f.ul.empty().hide();f.open=false};f.apply=function(h){if(!h){var h=f.value()}f.settings.apply.call(f,h)};f.value=function(){return f.selected().text()};f.selected=function(){return f.ul.find(".selected")};f.select=function(h){f.deselect();h.addClass("selected")};f.deselect=function(){f.selected().removeClass("selected")};f.prev=function(){var i=f.selected();var h=i.prev();if(h.length>0){f.select(h)}};f.next=function(){var i=f.selected();var h=(i.length>0)?i.next():f.ul.find("li:first-child");if(h.length>0){f.select(h)}};f.selection=function(){var j=f.input[0];var h=f.val;if(!j.createTextRange){return j.selectionStart}var k=document.selection.createRange().duplicate();k.moveEnd("character",h.length);if(k.text==""){return h.length}return h.lastIndexOf(k.text)};f.position=function(){var i=b.offset();var h=b.innerHeight();i.top=i.top+h+10;f.box.css(i)};f.init()};a.fn.autocomplete=function(c,b){return this.each(function(){if(undefined==a(this).data("autocomplete")){var d=new a.autocomplete(this,c,b);a(this).data("autocomplete",d)}})}})(jQuery);(function(a){a.tagbox=function(d,c){var g={url:false,autocomplete:{},lowercase:true,classname:"tagbox",separator:", ",duplicates:false,minLength:1,maxLength:140,keydown:function(){},onAdd:function(){},onRemove:function(){},onDuplicate:function(){return f.input.focus()},onInvalid:function(){return f.input.focus()},onReady:function(){}};var f=this;var e=null;f.settings={};var b=a(d),d=d;f.init=function(){f.settings=a.extend({},g,c);var k=b.attr("name");var j=b.attr("id");var h=b.val();f.index=[];f.val="";f.focused=false;f.origin=b.addClass("tagboxified").hide();f.box=a('<div class="'+f.settings.classname+'"><ul><li class="new"><input autocomplete="off" tabindex="0" type="text" /></li></ul></div>');f.input=f.box.find("input").css("width",20);f.bhits=0;f.lhits=0;if(f.settings.url){var i={apply:function(l){f.add(l);this.kill();f.input.focus()}};f.input.autocomplete(f.settings.url,a.extend({},i,f.settings.autocomplete));f.autocomplete=f.input.data("autocomplete");f.settings.onAdd=function(l){f.autocomplete.ignore=f.serialize()};f.settings.onRemove=function(l){f.autocomplete.ignore=f.serialize()}}f.origin.before(f.box);f.measure=a('<div style="display: inline" />').css({"font-size":f.input.css("font-size"),"font-family":f.input.css("font-family"),visibility:"hidden",position:"absolute",top:-10000,left:-10000});a("body").append(f.measure);f.box.click(function(l){f.focus();f.input.focus();l.stopPropagation()});f.input.keydown(function(l){f.val=f.input.val();f.position=f.selection();f.settings.keydown.call(f,l,f.val)});f.input.keyup(function(l){f.val=f.input.val();f.position=f.selection();f.resize(f.val);if(f.val.match(new RegExp(f.settings.separator))){f.add(f.val)}});f.input.focus(function(l){f.input.focused=true;f.deselect();f.bhits=0;f.focus()});f.input.blur(function(l){f.input.focused=false;f.bhits=0;if(f.val.length==0){f.blur()}f.val=""});f.settings.onReady.call(this);a(document).keydown(function(l){if(!f.focused){return true}switch(l.keyCode){case 8:if(!f.input.focused){f.remove();return false}if(f.val.length==0){f.next();return false}else{if(f.position==0){if(f.bhits>0){f.bhits=0;f.next();return false}f.bhits++}}break;case 37:if(!f.input.focused){return f.previous()}if(f.val.length==0){f.next();return false}else{if(f.position==0){if(f.lhits>0){f.lhits=0;f.next();return false}f.lhits++}}break;case 39:if(!f.input.focused){f.next();return false}break;case 9:if(f.input.focused&&f.val.length>f.settings.minLength){f.add(f.val);return false}else{if(f.selected().length>0){f.deselect();f.input.focus();return false}}break;case 13:case 188:if(f.input.focused){if(!f.settings.autocomplete){f.add(f.val)}return false}break}}).click(function(l){if(f.val.length>0){f.add(f.val)}});if(h.length>0){f.add(h)}};f.resize=function(h){f.measure.text(h);f.input.css("width",f.measure.width()+20)},f.focus=function(h){if(f.focused){return true}a(".tagboxified").not(f.origin).each(function(){if(a(this).data("tagbox")){a(this).data("tagbox").blur()}});f.box.addClass("focus");f.focused=true;if(h==undefined){var h=true}if(h!==false){f.input.focus()}};f.blur=function(){if(!f.focused){return true}f.box.removeClass("focus");f.focused=false;f.input.blur();f.deselect()};f.tag=function(h){h=h.replace(/,/g,"").replace(/;/g,"");if(f.settings.lowercase){h=h.toLowerCase()}return a.trim(h)};f.serialize=function(){return f.index};f.string=function(){return f.serialize().toString()};f.add=function(i){f.input.val("");if(!i&&f.val.length>0){return f.add(f.val)}else{if(!i){return true}}if(a.isArray(i)||i.match(new RegExp(f.settings.separator))){var j=(a.isArray(i))?i:i.split(f.settings.separator);a.each(j,function(m,l){f.add(l)});return true}var i=f.tag(i);if(i.length<f.settings.minLength||i.length>f.settings.maxLength){return f.settings.onInvalid.call(f,i,length)}if(f.settings.duplicates==false){if(a.inArray(i,f.index)>-1){return f.settings.onDuplicate.call(f,i)}}f.index.push(i);var h=a('<li><span class="tag"></span><span class="delete">&#215;</span></li>').data("tag",i);h.find(".tag").text(i);h.find(".delete").click(function(){f.remove(h)});h.click(function(l){f.blur();l.stopPropagation();f.select(h)});h.focus(function(l){f.select(h)});f.input.parent().before(h);f.input.val("");f.input.css("width",20);var k=f.serialize();f.origin.val(k.join(f.settings.separator));f.settings.onAdd.call(f,i,k,h)};f.select=function(h){if(typeof h=="string"){var h=f.find(h);if(!h){return false}}if(h.length==0){return false}f.input.blur();this.deselect();h.addClass("selected");f.focus(false)};f.selected=function(){return f.box.find(".selected")};f.deselect=function(){var h=f.selected();h.removeClass("selected")};f.find=function(h){var i=false;f.box.find("li").not(".new").each(function(){if(a(this).data("tag")==h){i=a(this)}});return i};f.remove=function(i){f.input.val("");if(typeof i=="string"){var i=f.find(i);if(!i){return false}}var j=f.selected();if(!i&&j.length>0){var i=j.first()}var k=f.previous(true);(k.length==0)?f.next():f.select(k);var h=i.find(".tag").text();f.removeFromIndex(h);i.remove();var l=f.serialize();f.origin.val(l);f.settings.onRemove.call(f,h,l,i)};f.removeFromIndex=function(h){var j=f.index.indexOf(h);f.index.splice(j,1)};f.selection=function(){var j=f.input[0];var h=f.val;if(!j.createTextRange){return j.selectionStart}var k=document.selection.createRange().duplicate();k.moveEnd("character",h.length);if(k.text==""){return h.length}return h.lastIndexOf(k.text)};f.previous=function(h){var j=f.selected();var i=(j.length==0)?f.box.find("li").not(".new").first():j.prev().not(".new");return(h)?i:f.select(i)};f.next=function(h){var j=f.selected();var i=(j.length==0)?f.box.find("li").not(".new").last():j.next();return(h)?i:(i.hasClass("new"))?f.input.focus():f.select(i)};f.init()};a.fn.tagbox=function(b){return this.each(function(){if(undefined==a(this).data("tagbox")){var c=new a.tagbox(this,b);a(this).data("tagbox",c)}})}})(jQuery);